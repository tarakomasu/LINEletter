```mermaid
graph TD
    A[/"開始: ユーザーがランディングページにアクセス"/] --> B{"LINEでログイン"};
    B --> C["認証処理 (NextAuth.js)"];
    C --> D{/"ログイン成功"/};
    D --> E[/"アプリ一覧ページにリダイレクト"/];
    E --> F["LINE Letterサービスを選択"];
    F --> G{"デバイス判定 (Mobile/Desktop)"};
    G --> H[/"エディタページに遷移"/];
    H --> I["手紙の作成・編集"];
    subgraph 手紙の編集機能
        I1["テンプレート選択"]
        I2["テキスト追加・編集"]
        I3["画像追加"]
        I4["ページ追加・削除"]
    end
    I --> J["保存ボタンをクリック"];
    J --> K["手紙を画像として生成 (PNG)"];
    K --> L["Supabase Storageに画像をアップロード"];
    L --> M{/"画像保存成功"/};
    M --> N["「LINEで送信」ボタンを表示"];
    N --> O["ボタンをクリック"];
    O --> P["LINEの共有画面 (LIFF) を表示"];
    P --> Q["送信先の友だちやグループを選択"];
    Q --> R[/"LINEのトークに手紙が送信される"/];
    R --> S[/"終了"/];

    C --> B;
    D -- "失敗" --> B;
```
